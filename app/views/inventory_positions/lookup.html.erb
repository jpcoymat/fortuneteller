<h1>Inventory Positions</h1>
 <p>Please select a Product and Location to see projections.</p>
  <%= form_for :inventory_position_search, url: lookup_inventory_positions_path, html: {class: "form-inline"}  do |form| %>
        <%= form.label "Location" %> <%= form.select :location_id, @locations.collect {|location| [location.name, location.id]} %>
        <%= render partial: "product_autocomplete", locals: {form: form} %>
	<%= form.label "Begin Projection Date" %>
        <%= form.text_field :begin_date %>
        <script>
          $( "#inventory_position_search_begin_date" ).datepicker({minDate: 0, maxDate: "<%=@organization.days_to_project%>D", dateFormat: "yy-mm-dd"});
        </script>
        <%= form.label "End Projection Date" %>
        <%= form.text_field :end_date  %>
        <script>
          $( "#inventory_position_search_end_date" ).datepicker({minDate: 0, maxDate: "<%=@organization.days_to_project%>D", dateFormat: "yy-mm-dd"});
        </script>
        <%= submit_tag "Lookup Projections", class: "btn btn-primary" %> 
  <% end %>
  <br \><br \>
  <hr>
  <% if request.post? %>
    <% if @inventory_position.nil? %>
       <p>There are no Inventory Positon records for the product and location chosen.</p>	
    <% else %>
       <%= column_chart(@data, library: {
					curveType: 'function',
					title: "Inventory Projections for SKU " + @inventory_position.product.name + " at location " + @inventory_position.location.name,
					legend:
						{position: "bottom"},
					series: 
						{0 => {type: "line", pointSize: 0, color: "red"},
						1 => {type: "line", pointSize: 0, color: "#336699" },
						2 => {targetAxisIndex: 1, color: "#FF6600" }, 
						3 => {targetAxisIndex: 1, color: "#666633" },
						4 => {targetAxisIndex: 1, color: "#FFCC00" },
						5 => {targetAxisIndex: 1, color: "#26ba26" },
						6 => {type: "line", pointSize: 0, color: "#E96D63"},
						7 => {type: "line", pointSize: 0, color: "red"} 
						}, 
					vAxes: [{0 => {textStyle:{color: 'red'}}},{1 => {textStyle:{color: 'blue'}}}]})    %>	
	 <br \> <br \><br \>
	<h4>Detailed Inventory Projection Data</h4>
	<table class="table table-striped">
          <tr><th>Date</th><th>On Hand </th> <th>On Order </th><th>In Transit</th> <th>Allocated </th> <th>Planned Consumption</th><th>Available</th></tr>
 	 <% @projections.each do |inventory_projection| %>
            <tr>	<td><%= link_to(inventory_projection.projected_for.to_s, [@inventory_position,inventory_projection]) %></td>
 		<td><%= inventory_projection.on_hand_quantity.to_s %></td>
 		<td><%= inventory_projection.on_order_quantity.to_s %></td>
 		<td><%= inventory_projection.in_transit_quantity.to_s %></td>
 		<td><%= inventory_projection.allocated_quantity.to_s %></td>
 		<td><%= inventory_projection.forecasted_quantity.to_s %></td>
 		<td><%= inventory_projection.available_quantity.to_s %></td>
 	  </tr>  
          <% end %>	 
        </table>
    <% end %>
  <% end %>
  <br \> <br \><br \>
  <%= link_to "Main Menu", main_index_path %>
  <br \> <br \><br \>

